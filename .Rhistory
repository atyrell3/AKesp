authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
?readlines
?readLines
?cat
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
?knitr::knit_child
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
?writeLines
?knitr::knit_child
text <- readtext::readtext(file = here::here("snow_crab/full-esp-text-template.docx"))
head(text)
text
head(text$text)
# This template can be used to create a full or partial ESP
# The text content is read in from a word document
# The word document should be created based on the template
# Headings and table/figure references must follow specific formatting
knitr::opts_chunk$set(
echo = FALSE,
warning = FALSE,
results = "asis"
)
fig_spreadsheet <- params$fig_spreadsheet
tab_spreadsheet <- params$tab_spreadsheet
ref_spreadsheet <- params$ref_spreadsheet
esp_text <- params$esp_text
con_model_path <- params$con_model_path
bayes_path <- params$bayes_path
stock_image <- params$stock_image
if(stock_image == "default"){
stock_image <- system.file("images/noaa.jpg", package = "AKesp")
}
if(con_model_path == "default"){
con_model_path <- system.file("images/noaa.jpg", package = "AKesp")
}
if(bayes_path == "default"){
bayes_path <- system.file("images/noaa.jpg", package = "AKesp")
}
temp_file <- "temp-text.txt"
invisible(file.create(temp_file))
writeLines(text = text$text, con = temp_file)
temp_file <- here::here("temp-text.txt")
invisible(file.create(temp_file))
writeLines(text = text$text, con = temp_file)
new_text <- readLines(temp_file)
head(new_text)
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
cat(new_text, sep = "\n\n")
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
new_text2 <- cat(new_text, sep = "\n\n")
new_text2
new_text2 <- paste(new_text, sep = "\n\n")
new_text2
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
# create .Rmd
temp_Rmd <- here::here("snow_crab/temp-text.Rmd")
invisible(file.create(temp_Rmd))
writeLines(text = new_text, con = temp_Rmd)
?writeLines
?file.create
fish = "Snow Crab",
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
?knit_child
res <- knitr::knit_child(text = new_text,
quiet = TRUE)
res
new_text
invisible(file.create(temp_Rmd))
writeLines(text = new_text, con = temp_Rmd)
?file.create
text <- readtext::readtext(file = esp_text)
writeLines(text = text$text, con = temp_file)
new_text <- readLines(temp_file)
# remove instructions section
new_text <- new_text[stringr::str_which(new_text, "# Executive Summary"):length(new_text)]
# create .Rmd
temp_Rmd <- "temp-text.Rmd"
invisible(file.create(temp_Rmd))
writeLines(text = new_text, con = temp_Rmd)
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
paste(new_text)
paste(new_text, sep = "\n\n")
paste(new_text, collapse = "\n\n")
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
# snow crab!!
devtools::load_all()
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
here::here("temp-text.Rmd")
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
res <- knitr::knit_child(
temp_Rmd, envir = environment(), quiet = TRUE
)
res <- knitr::knit_child(
here::here("temp-text.Rmd"), envir = environment(), quiet = TRUE
)
res
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
?knit_child
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
# This template can be used to create a full or partial ESP
# The text content is read in from a word document
# The word document should be created based on the template
# Headings and table/figure references must follow specific formatting
knitr::opts_chunk$set(
echo = FALSE,
warning = FALSE,
results = "asis"
)
fig_spreadsheet <- params$fig_spreadsheet
tab_spreadsheet <- params$tab_spreadsheet
ref_spreadsheet <- params$ref_spreadsheet
esp_text <- params$esp_text
con_model_path <- params$con_model_path
bayes_path <- params$bayes_path
stock_image <- params$stock_image
if(stock_image == "default"){
stock_image <- system.file("images/noaa.jpg", package = "AKesp")
}
if(con_model_path == "default"){
con_model_path <- system.file("images/noaa.jpg", package = "AKesp")
}
if(bayes_path == "default"){
bayes_path <- system.file("images/noaa.jpg", package = "AKesp")
}
temp_file <- "temp-text.txt"
new_text <- readLines(temp_file)
# remove instructions section
new_text <- new_text[stringr::str_which(new_text, "# Executive Summary"):length(new_text)]
# knit .Rmd
knit_Rmd <- here::here("temp-text-knit.txt")
knitr::knit(input = new_text,
output = knit_Rmd,
quiet = TRUE)
knit_Rmd <- here::here("temp-text-knit.txt")
invisible(file.create(knit_Rmd))
knitr::knit(input = temp_Rmd,
output = knit_Rmd,
quiet = TRUE)
knit_Rmd <- here::here("temp-text-knit.txt")
invisible(file.create(knit_Rmd))
knitr::knit(input = new_text,
output = knit_Rmd,
quiet = TRUE)
knit_Rmd <- here::here("temp-text-knit.txt")
invisible(file.create(knit_Rmd))
knitr::knit(text = new_text,
output = knit_Rmd,
quiet = TRUE)
new_text
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
render_esp(out_dir = here::here("snow_crab"),
out_name = "snow_crab_test.docx",
authors = "Erin Fedewa, Kalei Shotwell, Abby Tyrell",
year = 2022,
fish = "Snow Crab",
region = "Eastern Bering Sea",
tab_spreadsheet = 1,
esp_text = here::here("snow_crab/full-esp-text-template.docx"),
esp_data = AKesp::get_esp_data("BS Snow Crab") %>% check_data())
