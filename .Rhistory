ggplot2::theme(
plot.title =
ggplot2::element_text(size = 10,
hjust = 0.5)
)
# bayes ----
bay <- png::readPNG(bayes_path)
bayes <- ggplot2::ggplot() +
ggplot2::theme_void() +
ggplot2::theme(aspect.ratio = 1) +
ggpubr::background_image(bay) +
ggplot2::ggtitle("Importance") +
ggplot2::theme(
plot.title =
ggplot2::element_text(size = 10,
hjust = 0.5)
)
# right hand figures - score and bayes ----
right_figs <- ggpubr::ggarrange(
score_fig,
bayes,
nrow = 2
)
# all figs ----
figs <- ggpubr::ggarrange(
fig,
right_figs,
ncol = 2,
widths = c(2, 1)
)
# header ----
head <- png::readPNG(header_path)
header <- ggplot2::ggplot() +
ggplot2::theme_void() +
ggplot2::theme(aspect.ratio = 1 / 4) +
ggpubr::background_image(head)
# text header ----
h_txt <- ggplot2::ggplot() +
ggplot2::theme_void() +
ggplot2::annotate("text", x = 1, y = 1, label = head_text) +
ggplot2::theme(text = element_text(size = 8))
# text footer ----
txt <- ggplot2::ggplot() +
ggplot2::theme_void() +
ggplot2::annotate("text", x = 1, y = 1, label = foot_text) +
ggplot2::theme(text = element_text(size = 8))
# put it all together ----
summary_pg <- ggpubr::ggarrange(header,
h_txt,
figs,
ggtab,
txt,
nrow = 5,
heights = c(2, 0.5, 5.5, 2.5, 0.5)
)
ggplot2::ggsave(output_name,
width = 8.5,
height = 11
)
}
one_pager(data = dat2, overall_data = dat)
one_pager <- function(data,
overall_data,
years = 2017:2021,
head_text = "some text",
foot_text = "more text",
bayes_path = here::here("bayes.png"),
header_path = here::here("header.png"),
output_name = "one-pager.pdf") {
# indicator figure ----
fig <- AKesp::esp_traffic_long(
data = data,
paginate = FALSE,
out = "one_pager",
silent = TRUE,
ncolumn = 2,
label = FALSE,
status = FALSE
) +
ggplot2::ggtitle("Indicators") +
ggplot2::theme_bw(base_size = 8) +
ggplot2::theme(
plot.title =
ggplot2::element_text(size = 10,
hjust = 0.5)
)
# score figure ----
score_fig <- AKesp::esp_overall_score(
data = overall_data,
species = "",
region = "",
out = "one_pager"
) +
ggplot2::ggtitle("Overall score") +
ggplot2::theme(text = ggplot2::element_text(size = 8),
plot.title = ggplot2::element_text(size = 10,
hjust = 0.5),
plot.margin = grid::unit(c(0,0,0,4), units = "points"),
legend.box.margin = ggplot2::margin(0, 0, 0, 0, unit = "pt"),
legend.box.spacing = grid::unit(c(0,0,0,0), units = "points"),
legend.spacing = grid::unit(c(0,0,0,0), units = "points"),
legend.margin = ggplot2::margin(0, 0, 0, 0, unit = "pt"),
legend.text =
ggplot2::element_text(margin =
ggplot2::margin(0, 0, 0, 0, unit = "pt")),
legend.key.height= grid::unit(c(8, 8, 8, 8), units = "points")
) +
ggplot2::ylab(ggplot2::element_blank())
# make a table ----
tab <- AKesp::esp_traffic_tab_long(data,
year = years,
cap = ""
) %>%
flextable::fit_to_width(max_width = 8)
ggtab <- ggplot2::ggplot() +
ggplot2::theme_void() +
ggplot2::annotation_custom(grid::rasterGrob(flextable::as_raster(tab)),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf
) +
ggplot2::ggtitle("Traffic light table") +
ggplot2::theme(
plot.title =
ggplot2::element_text(size = 10,
hjust = 0.5)
)
# bayes ----
bay <- png::readPNG(bayes_path)
bayes <- ggplot2::ggplot() +
ggplot2::theme_void() +
ggplot2::theme(aspect.ratio = 1) +
ggpubr::background_image(bay) +
ggplot2::ggtitle("Importance") +
ggplot2::theme(
plot.title =
ggplot2::element_text(size = 10,
hjust = 0.5)
)
# right hand figures - score and bayes ----
right_figs <- ggpubr::ggarrange(
score_fig,
bayes,
nrow = 2
)
# all figs ----
figs <- ggpubr::ggarrange(
fig,
right_figs,
ncol = 2,
widths = c(2, 1)
)
# header ----
head <- png::readPNG(header_path)
header <- ggplot2::ggplot() +
ggplot2::theme_void() +
ggplot2::theme(aspect.ratio = 1 / 4) +
ggpubr::background_image(head)
# text header ----
h_txt <- ggplot2::ggplot() +
ggplot2::theme_void() +
ggplot2::annotate("text", x = 1, y = 1, label = head_text) +
ggplot2::theme(text = ggplot2::element_text(size = 8))
# text footer ----
txt <- ggplot2::ggplot() +
ggplot2::theme_void() +
ggplot2::annotate("text", x = 1, y = 1, label = foot_text) +
ggplot2::theme(text = ggplot2::element_text(size = 8))
# put it all together ----
summary_pg <- ggpubr::ggarrange(header,
h_txt,
figs,
ggtab,
txt,
nrow = 5,
heights = c(2, 0.5, 5.5, 2.5, 0.5)
)
ggplot2::ggsave(output_name,
width = 8.5,
height = 11
)
}
one_pager(data = dat2, overall_data = dat)
one_pager <- function(data,
overall_data,
years = 2017:2021,
head_text = "some text",
foot_text = "more text",
bayes_path = here::here("bayes.png"),
header_path = here::here("header.png"),
output_name = "one-pager.pdf") {
# indicator figure ----
fig <- AKesp::esp_traffic_long(
data = data,
paginate = FALSE,
out = "one_pager",
silent = TRUE,
ncolumn = 2,
label = FALSE,
status = FALSE
) +
ggplot2::ggtitle("Indicators") +
ggplot2::theme_bw(base_size = 8) +
ggplot2::theme(
plot.title =
ggplot2::element_text(size = 10,
hjust = 0.5)
)
# score figure ----
score_fig <- AKesp::esp_overall_score(
data = overall_data,
species = "",
region = "",
out = "one_pager"
) +
ggplot2::ggtitle("Overall score") +
ggplot2::theme(text = ggplot2::element_text(size = 8),
plot.title = ggplot2::element_text(size = 10,
hjust = 0.5),
plot.margin = grid::unit(c(0,4,0,0), units = "points"),
legend.box.margin = ggplot2::margin(0, 0, 0, 0, unit = "pt"),
legend.box.spacing = grid::unit(c(0,0,0,0), units = "points"),
legend.spacing = grid::unit(c(0,0,0,0), units = "points"),
legend.margin = ggplot2::margin(0, 0, 0, 0, unit = "pt"),
legend.text =
ggplot2::element_text(margin =
ggplot2::margin(0, 0, 0, 0, unit = "pt")),
legend.key.height= grid::unit(c(8, 8, 8, 8), units = "points")
) +
ggplot2::ylab(ggplot2::element_blank())
# make a table ----
tab <- AKesp::esp_traffic_tab_long(data,
year = years,
cap = ""
) %>%
flextable::fit_to_width(max_width = 8)
ggtab <- ggplot2::ggplot() +
ggplot2::theme_void() +
ggplot2::annotation_custom(grid::rasterGrob(flextable::as_raster(tab)),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf
) +
ggplot2::ggtitle("Traffic light table") +
ggplot2::theme(
plot.title =
ggplot2::element_text(size = 10,
hjust = 0.5)
)
# bayes ----
bay <- png::readPNG(bayes_path)
bayes <- ggplot2::ggplot() +
ggplot2::theme_void() +
ggplot2::theme(aspect.ratio = 1) +
ggpubr::background_image(bay) +
ggplot2::ggtitle("Importance") +
ggplot2::theme(
plot.title =
ggplot2::element_text(size = 10,
hjust = 0.5)
)
# right hand figures - score and bayes ----
right_figs <- ggpubr::ggarrange(
score_fig,
bayes,
nrow = 2
)
# all figs ----
figs <- ggpubr::ggarrange(
fig,
right_figs,
ncol = 2,
widths = c(2, 1)
)
# header ----
head <- png::readPNG(header_path)
header <- ggplot2::ggplot() +
ggplot2::theme_void() +
ggplot2::theme(aspect.ratio = 1 / 4) +
ggpubr::background_image(head)
# text header ----
h_txt <- ggplot2::ggplot() +
ggplot2::theme_void() +
ggplot2::annotate("text", x = 1, y = 1, label = head_text) +
ggplot2::theme(text = ggplot2::element_text(size = 8))
# text footer ----
txt <- ggplot2::ggplot() +
ggplot2::theme_void() +
ggplot2::annotate("text", x = 1, y = 1, label = foot_text) +
ggplot2::theme(text = ggplot2::element_text(size = 8))
# put it all together ----
summary_pg <- ggpubr::ggarrange(header,
h_txt,
figs,
ggtab,
txt,
nrow = 5,
heights = c(2, 0.5, 5.5, 2.5, 0.5)
)
ggplot2::ggsave(output_name,
width = 8.5,
height = 11
)
}
one_pager(data = dat2, overall_data = dat)
one_pager <- function(data,
overall_data,
years = 2017:2021,
head_text = "some text",
foot_text = "more text",
bayes_path = here::here("bayes.png"),
header_path = here::here("header.png"),
output_name = "one-pager.pdf") {
# indicator figure ----
fig <- AKesp::esp_traffic_long(
data = data,
paginate = FALSE,
out = "one_pager",
silent = TRUE,
ncolumn = 2,
label = FALSE,
status = FALSE
) +
ggplot2::ggtitle("Indicators") +
ggplot2::theme_bw(base_size = 8) +
ggplot2::theme(
plot.title =
ggplot2::element_text(size = 10,
hjust = 0.5)
) +
ggplot2::xlab(ggplot2::element_blank())
# score figure ----
score_fig <- AKesp::esp_overall_score(
data = overall_data,
species = "",
region = "",
out = "one_pager"
) +
ggplot2::ggtitle("Overall score") +
ggplot2::theme(text = ggplot2::element_text(size = 8),
plot.title = ggplot2::element_text(size = 10,
hjust = 0.5),
plot.margin = grid::unit(c(0,8,0,0), units = "points"),
legend.box.margin = ggplot2::margin(0, 0, 0, 0, unit = "pt"),
legend.box.spacing = grid::unit(c(0,0,0,0), units = "points"),
legend.spacing = grid::unit(c(0,0,0,0), units = "points"),
legend.margin = ggplot2::margin(0, 0, 0, 0, unit = "pt"),
legend.text =
ggplot2::element_text(margin =
ggplot2::margin(0, 0, 0, 0, unit = "pt")),
legend.key.height= grid::unit(c(8, 8, 8, 8), units = "points")
) +
ggplot2::ylab(ggplot2::element_blank())
# make a table ----
tab <- AKesp::esp_traffic_tab_long(data,
year = years,
cap = ""
) %>%
flextable::fit_to_width(max_width = 8)
ggtab <- ggplot2::ggplot() +
ggplot2::theme_void() +
ggplot2::annotation_custom(grid::rasterGrob(flextable::as_raster(tab)),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf
) +
ggplot2::ggtitle("Traffic light table") +
ggplot2::theme(
plot.title =
ggplot2::element_text(size = 10,
hjust = 0.5)
)
# bayes ----
bay <- png::readPNG(bayes_path)
bayes <- ggplot2::ggplot() +
ggplot2::theme_void() +
ggplot2::theme(aspect.ratio = 1) +
ggpubr::background_image(bay) +
ggplot2::ggtitle("Importance") +
ggplot2::theme(
plot.title =
ggplot2::element_text(size = 10,
hjust = 0.5)
)
# right hand figures - score and bayes ----
right_figs <- ggpubr::ggarrange(
score_fig,
bayes,
nrow = 2
)
# all figs ----
figs <- ggpubr::ggarrange(
fig,
right_figs,
ncol = 2,
widths = c(2, 1)
)
# header ----
head <- png::readPNG(header_path)
header <- ggplot2::ggplot() +
ggplot2::theme_void() +
ggplot2::theme(aspect.ratio = 1 / 4) +
ggpubr::background_image(head)
# text header ----
h_txt <- ggplot2::ggplot() +
ggplot2::theme_void() +
ggplot2::annotate("text", x = 1, y = 1, label = head_text) +
ggplot2::theme(text = ggplot2::element_text(size = 8))
# text footer ----
txt <- ggplot2::ggplot() +
ggplot2::theme_void() +
ggplot2::annotate("text", x = 1, y = 1, label = foot_text) +
ggplot2::theme(text = ggplot2::element_text(size = 8))
# put it all together ----
summary_pg <- ggpubr::ggarrange(header,
h_txt,
figs,
ggtab,
txt,
nrow = 5,
heights = c(2, 0.5, 5.5, 2.5, 0.5)
)
ggplot2::ggsave(output_name,
width = 8.5,
height = 11
)
}
one_pager(data = dat2, overall_data = dat)
styler::style_file(here::here("R/one-pager.R"))
styler::style_file(here::here("R/one-pager.R"))
dat <- AKesp::get_esp_data("BS Snow Crab")
dat
unique(dat$INDICATOR_NAME)
dat <- AKesp::get_esp_data("BS Snow Crab")
head(dat)
dat
unique(dat$IINDICATOR_NAME)
unique(dat$INDICATOR_NAME)
dat <- AKesp::get_esp_data("BS Snow Crab")
unique(dat$INDICATOR_NAME)
dat <- AKesp::get_esp_data("BS Snow Crab")
unique(dat$IINDICATOR_NAME)
unique(dat$INDICATOR_NAME)
dat <- AKesp::get_esp_data("BS Snow Crab")
unique(dat$INDICATOR_NAME)
dat <- AKesp::get_esp_data("BS Snow Crab")
unique(dat$INDICATOR_NAME)
dat <- AKesp::get_esp_data("BS Snow Crab")
head(dat)
unique(dat$INDICATOR_NAME)
dat <- AKesp::get_esp_data("BS Snow Crab")
unique(dat$INDICATOR_NAME)
dat <- AKesp::get_esp_data("BS Snow Crab")
unique(dat$INDICATOR_NAME)
googledrive::drive_user
googledrive::drive_auth()
googledrive::drive_find(pattern = "TEMPLATES")
googledrive::drive_find(pattern = "TEMPLATES/snow_crab")
googledrive::drive_find(pattern = "TEMPLATES/snow_crab", nmax = 10)
googledrive::drive_find(pattern = "TEMPLATES/snow_crab", n_max = 10)
googledrive::drive_find(pattern = "TEMPLATES/snow_crab", n_max = 100)
googledrive::drive_find(pattern = "TEMPLATES", n_max = 100)
googledrive::drive_find(pattern = "TEMPLATES/IMAGES", n_max = 100)
googledrive::drive_find(pattern = "TEMPLATES/IMAGES/noaa.jpeg", n_max = 100)
googledrive::drive_find(q = "name contains 'TEMPLATES/IMAGES/noaa.jpeg'", n_max = 100)
googledrive::drive_ls()
?googledrive::drive_ls
googledrive::drive_ls("ALASKA")
googledrive::drive_ls("Alaska")
googledrive::drive_find(pattern = "Alaska/TEMPLATES/IMAGES/noaa.jpeg", n_max = 100)
googledrive::drive_ls("Alaska/TEMPLATES")
googledrive::drive_ls("Alaska/TEMPLATES/IMAGES")
googledrive::drive_ls("1bTrzyWMdBA0U_TxEix17cOP3H9xt7U74")
googledrive::drive_ls(googledrive::as_id("1bTrzyWMdBA0U_TxEix17cOP3H9xt7U74"))
googledrive::drive_ls("Alaska/TEMPLATES/IMAGES")
googledrive::drive_ls("Alaska/TEMPLATES/IMAGES/")
googledrive::drive_find(pattern = "Alaska/TEMPLATES/IMAGES")
googledrive::drive_get("~/Alaska/TEMPLATES/IMAGES/noaa.jpeg")
googledrive::drive_get("/Alaska/TEMPLATES/IMAGES/noaa.jpeg")
googledrive::drive_get("Alaska/TEMPLATES/IMAGES/noaa.jpeg")
googledrive::drive_find("Alaska/TEMPLATES/IMAGES/noaa.jpeg")
googledrive::drive_find("Alaska/TEMPLATES/IMAGES/noaa.jpeg", n_max = 10)
googledrive::drive_find("~/Alaska/TEMPLATES/IMAGES/noaa.jpeg", n_max = 10)
googledrive::drive_ls("Alaska/TEMPLATES", recursive = TRUE)
googledrive::drive_ls("Alaska/TEMPLATES/IMAGES", recursive = TRUE)
rlang::last_error()
googledrive::drive_find("noaa.jpeg", n_max = 10)
googledrive::drive_find(q = "sharedWithMe and name contains 'noaa.jpeg'", n_max = 10)
googledrive::drive_find(q = "sharedWithMe", n_max = 10)
googledrive::drive_find("noaa", n_max = 10)
googledrive::drive_find("Alaska/TEMPLATES/IMAGESnoaa", n_max = 10)
googledrive::drive_find("Alaska/TEMPLATES/IMAGES/noaa", n_max = 10)
googledrive::drive_find(q = "sharedWithMe and name contains 'noaa'", n_max = 10)
googledrive::drive_find(q = "sharedWithMe and name contains 'IMAGES/noaa'", n_max = 10)
googledrive::drive_find(q = "sharedWithMe and name contains 'noaa' and name contains 'TEMPLATES'", n_max = 10)
file <- googledrive::drive_find("noaa", n_max = 10)
file
googledrive::drive_get(file)
googledrive::drive_get(id = file$id)
?drive_Find
?drive_find
?drive_get
file <- googledrive::drive_get(id = "https://drive.google.com/file/d/1ztcI_hjisYcKbE2fx1zjOEjHdmrJ89xG/view?usp=sharing")
file
drive_get(id = "https://drive.google.com/drive/folders/1bTrzyWMdBA0U_TxEix17cOP3H9xt7U74")
googledrive::drive_get(id = "https://drive.google.com/drive/folders/1bTrzyWMdBA0U_TxEix17cOP3H9xt7U74")
googledrive::drive_get(id = "https://drive.google.com/drive/folders/1bTrzyWMdBA0U_TxEix17cOP3H9xt7U74", recursive = TRUE)
googledrive::drive_find(id = "https://drive.google.com/drive/folders/1bTrzyWMdBA0U_TxEix17cOP3H9xt7U74", recursive = TRUE)
googledrive::drive_download(file = googledrive::as_id("https://drive.google.com/drive/folders/1bTrzyWMdBA0U_TxEix17cOP3H9xt7U74"))
googledrive::drive_find(pattern = "IMAGES", recursive = TRUE)
googledrive::drive_find(pattern = "IMAGES")
googledrive::drive_find(pattern = "IMAGES", n_max = 10)
?drive_get
?drive_find
# could try
folder <- googledrive::drive_find(pattern = "IMAGES", n_max = 10)
googledrive::drive_ls(path = googledrive::as_id(folder$id), recursive = TRUE)
googledrive::drive_ls(path = "Alaska/TEMPLATES", recursive = TRUE)
