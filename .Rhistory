devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg")
)
head(this_dat)
unique(this_dat$CATEGORY)
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
?stringr::str_wrap
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
dat <- AKesp::get_esp_data("Alaska Sablefish")
esp_traffic_tab_long(data = dat, year = 2016:2021)
devtools::load_all()
esp_traffic_tab_long(data = dat, year = 2016:2021)
devtools::load_all()
esp_traffic_tab_long(data = dat, year = 2016:2021)
devtools::load_all()
esp_traffic_tab_long(data = dat, year = 2016:2021)
devtools::load_all()
devtools::load_all()
esp_traffic_tab_long(data = dat, year = 2016:2021)
styler::style_file("R/table_functions.R")
devtools::load_all()
esp_traffic_tab_long(data = dat, year = 2016:2021)
roxygen2::roxygenise()
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
dat <- AKesp::get_esp_data("Alaska Sablefish")
head(dat)
unique(dat$CATEGORY)
dat %>% dplyr::select(INDICATOR_NAME, INDICATOR_TYPE, CATEGORY) %>% dplyr::distinct()
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
View(dat)
devtools::load_all()
prep_ind_data(data = dat)
esp_overall_score <- function(data, species, out = "ggplot", name) {
dat <- data %>%
prep_ind_data() %>%
dplyr::filter(YEAR >= 2000) %>%
dplyr::group_by(.data$CATEGORY, .data$YEAR) %>%
dplyr::mutate(
score = as.numeric(score),
mean_score = mean(.data$score, na.rm = TRUE)
) %>%
dplyr::select(
YEAR, INDICATOR_NAME, CATEGORY, INDICATOR_TYPE,
score, mean_score
) %>%
dplyr::distinct()
dat$CATEGORY <- factor(dat$CATEGORY,
levels = c("Physical",
"Lower Trophic",
"Upper Trophic",
"Fishery Performance",
"Economic",
"Community"))
ymax <- max(abs(dat$mean_score))
plt <- ggplot2::ggplot(
dat,
ggplot2::aes(
x = .data$YEAR,
y = .data$mean_score,
color = .data$CATEGORY
)
) +
ggplot2::geom_hline(
yintercept = 0,
lty = "dashed"
) +
ggplot2::geom_line() +
ggplot2::geom_point() +
ggplot2::ylab("Score") +
ggplot2::xlab(ggplot2::element_blank()) +
ggplot2::theme_bw(base_size = 16) +
ggplot2::theme(
legend.title = ggplot2::element_blank(),
legend.position = "bottom",
legend.direction = "vertical",
) +
ggplot2::ggtitle(label = paste("Overall Stage 1 Score for", species)) +
ggplot2::ylim(-ymax, ymax) +
ggplot2::facet_grid(rows = ggplot2::vars(.data$INDICATOR_TYPE))
if (out == "save") {
ggplot2::ggsave(plt, filename = name, ...)
} else if (out == "ggplot") {
print(plt)
cat("\n\n")
} else {
stop("Please specify output format")
}
}
esp_overall_score(data = dat, species = "test")
?theme
devtools::load_all()
dat <- AKesp::get_esp_data("Alaska Sablefish")
esp_overall_score(data = dat, species = "test")
roxygen2::roxygenise()
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
devtools::load_all()
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
roxygen2::roxygenise()
indicator_order <- read.csv(here::here("data-raw/ESP_Lookup_Order.csv"))
usethis::use_data(indicator_order)
my_save <- function(x) {
data <- get(x)
sinew::makeOxygen(data)
print(x)
}
sink("R/data2.R")
my_save("indicator_order")
sink()
head(indicator_order)
tail(indicator_order)
roxygen2::roxygenise()
dat <- AKesp::get_esp_data("Alaska Sablefish")
AKesp::prep_ind_data(data = dat)
head(dat)
View(head(dat))
head(indicator_order)
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
prep_ind_data(data = dat)
head(dat)
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
warnings()
?ggplot2::geom_label
?scale_fontface_manual
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
?fontface
?ggplot2::geom_label
devtools::load_all()
rmarkdown::render(here::here("inst/esp-report-card-template.Rmd"),
clean = FALSE,
params = list(esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "images/noaa.jpg",
con_model_path = "images/noaa.jpg",
bayes_path = "images/noaa.jpg"))
roxygen2::roxygenise()
pkgdown::build_site()
my_save <- function(x) {
data <- get(x)
sinew::makeOxygen(data)
print(x)
}
sink("R/data2.R")
my_save("bbrkc_long")
sink()
roxygen2::roxygenise()
styler::style_dir("R")
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
roxygen2::roxygenise()
pkgdown::build_site()
pkgdown::build_site()
styler::style_dir("vignettes", filetype = "Rmd")
>rmarkdown::render
?rmarkdown::render
styler::style_file("examples/developing_report_card.R")
# install package
devtools::install_github("atyrell3/AKesp")
?devtools::install_github
# install package
devtools::install_github("atyrell3/AKesp", upgrade = "never")
# install package
devtools::install_github("atyrell3/AKesp", upgrade = "never")
# score is calculated by the functions
# can change where output renders - defaults to working directory
# replace dummy figure paths with path to real figures (suggest to use `here` package)
# figure captions/numbers are not perfect, but should at least be a good starting point
# sample text was copied from the sablefish report card
rmarkdown::render(system.file("esp-report-card-template.Rmd",
package = "AKesp"
),
clean = TRUE,
output_dir = getwd(),
params = list(
esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "inst/images/noaa.jpg",
con_model_path = "inst/images/noaa.jpg",
bayes_path = "inst/images/noaa.jpg"
)
)
AKesp::get_esp_data
roxygen2::roxygenise()
remove.packages("AKesp")
# install package
devtools::install_github("atyrell3/AKesp", upgrade = "never")
# score is calculated by the functions
# can change where output renders - defaults to working directory
# replace dummy figure paths with path to real figures (suggest to use `here` package)
# figure captions/numbers are not perfect, but should at least be a good starting point
# sample text was copied from the sablefish report card
rmarkdown::render(system.file("esp-report-card-template.Rmd",
package = "AKesp"
),
clean = TRUE,
output_dir = getwd(),
params = list(
esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = "inst/images/noaa.jpg",
con_model_path = "inst/images/noaa.jpg",
bayes_path = "inst/images/noaa.jpg"
)
)
# score is calculated by the functions
# can change where output renders - defaults to working directory
# replace dummy figure paths with path to real figures (suggest to use `here` package)
# figure captions/numbers are not perfect, but should at least be a good starting point
# sample text was copied from the sablefish report card
rmarkdown::render(system.file("esp-report-card-template.Rmd",
package = "AKesp"
),
clean = TRUE,
output_dir = getwd(),
params = list(
esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = here::here("inst/images/noaa.jpg"),
con_model_path = here::here("inst/images/noaa.jpg"),
bayes_path = here::here("inst/images/noaa.jpg")
)
)
# install package
remove.packages("AKesp")
devtools::install_github("atyrell3/AKesp", upgrade = "never")
# score is calculated by the functions
# can change where output renders - defaults to working directory
# replace dummy figure paths with path to real figures (suggest to use `here` package)
# figure captions/numbers are not perfect, but should at least be a good starting point
# sample text was copied from the sablefish report card
rmarkdown::render(system.file("esp-report-card-template.Rmd",
package = "AKesp"
),
clean = TRUE,
output_dir = getwd(),
params = list(
esp_data = AKesp::get_esp_data("Alaska Sablefish"),
fish = "Sablefish",
region = "Alaska",
stock_image = here::here("inst/images/noaa.jpg"),
con_model_path = here::here("inst/images/noaa.jpg"),
bayes_path = here::here("inst/images/noaa.jpg")
)
)
?rmarkdown::render
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
head(NEesp::survey)
`%>%` <- magrittr::`%>%`
NEesp::survey %>% dplyr::filter(Species == "Bluefish")
dat <- NEesp::survey %>% dplyr::filter(Species == "Bluefish")
hist(dat$LENGTH)
dat <- NEesp::survey %>% dplyr::filter(Species == "Bluefish") %>% dplyr::select(date, fish_id, LENGTH, NUMLEN) %>% dplyr::distinct()
hist(dat$LENGTH * dat$NUMLEN)
head(dat)
hist(dat$NUMLEN)
dat %>% dplyr::filter(NUMLEN > 1)
dat %>% dplyr::filter(NUMLEN > 10)
dat %>% dplyr::filter(NUMLEN > 20)
dat %>% dplyr::filter(NUMLEN > 100)
dat %>% dplyr::filter(NUMLEN > 200)
?case_when
x <- 1:50
case_when(
x %% 35 == 0 ~ "fizz buzz",
x %% 5 == 0 ~ "fizz",
x %% 7 == 0 ~ "buzz",
TRUE ~ as.character(x)
)
x <- 1:50
dplyr::case_when(
x %% 35 == 0 ~ "fizz buzz",
x %% 5 == 0 ~ "fizz",
x %% 7 == 0 ~ "buzz",
TRUE ~ as.character(x)
)
?AKesp::get_esp_data()
AKesp::esp_stock_options()
head(AKesp::get_esp_data("Alaska Sablefish"))
devtools::load_all()
esp_stock_options()
dat <- get_esp_data("GOA Pacific Cod")
View(dat)
rmarkdown::render(system.file("esp-report-card-template.Rmd",
package = "AKesp"
),
output_dir = getwd(),
params = list(
esp_data = dat,
fish = "Sablefish",
region = "Alaska",
stock_image = here::here("inst/images/noaa.jpg"),
con_model_path = here::here("inst/images/noaa.jpg"),
bayes_path = here::here("inst/images/noaa.jpg")
)
)
prep_ind_data(dat)
unique(prep_ind_data(dat)$INDICATOR_NAME)
devtools::load_all()
unique(prep_ind_data(dat)$INDICATOR_NAME)
prep_ind_data(dat)
is.na(dat$GATE2_YEAR)
"NA" == NA
NA == "NA"
devtools::load_all()
prep_ind_data(dat)
unique(prep_ind_data(dat)$INDICATOR_NAME)
roxygen2::roxygenise()
devtools::load_all()
rmarkdown::render(system.file("esp-report-card-template.Rmd",
package = "AKesp"
),
output_dir = getwd(),
params = list(
esp_data = dat,
fish = "Sablefish",
region = "Alaska",
stock_image = here::here("inst/images/noaa.jpg"),
con_model_path = here::here("inst/images/noaa.jpg"),
bayes_path = here::here("inst/images/noaa.jpg")
)
)
# remove package before re-installing
remove.packages("AKesp")
